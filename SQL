SELECT
     SUM(SELLINGPRICE) AS TOTAL_REVENUE
FROM
  "CARINDUSTRY"."PUBLIC"."SHOP"

--CALCULATING THE NUMBER OF CARS WERE SOLD
 SELECT COUNT(*) TOTAL_SOLD_CARS,
   
   --CALCULATING THE TOTAL REVENUE
    SUM(SELLINGPRICE) AS TOTAL_REVENUE,
 
 --CONVERTING DATE INTO DATE FORMAT
  TO_DATE(SALEDATE, 'DY MON DD YYYY HH24:MI:SS') AS SALE_MONTH,
 
 --SELECTING THE COLUMNS
      MAKE,
      MODEL,
      TRANSMISSION,
      TRIM,
      BODY,
      SELLINGPRICE,
      VIN,
      ODOMETER,
      COLOR,
      INTERIOR,
      SELLER,
      MMR,
      STATE,
      CONDITION,
      YEAR,
    
    --CALCULATING THE AVERAGE 
     ROUND(AVG(MMR)) AS AVG_MARKET_VALUE,
      ROUND(AVG(SELLINGPRICE)) AS AVG_SELLING_PRICE,
      ROUND(AVG(SELLINGPRICE - MMR)) AS AVG_PROFIT_MARGI,
   
   ---COVERTING THE NULL ROWS INTO UNKNOWN
     CASE
         WHEN TRANSMISSION IS NULL THEN 'UNKNOWN'
         ELSE TRANSMISSION
      END AS TRANSMISSION_BUCKET
FROM
  "CARINDUSTRY"."PUBLIC"."SHOP"
GROUP BY ALL;
